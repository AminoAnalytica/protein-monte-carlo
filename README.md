# Protein‑MC

Minimal Metropolis Monte‑Carlo optimiser for **protein sequence design** (publication build accompanying the preprint).

---

## Installation

### 1. Quick test (install directly from GitHub)

```bash
pip install git+https://github.com/AminoAnalytica/protein-monte-carlo.git
```

*(pulls `pyproject.toml` and installs the published `protein‑mc` package)*

### 2. Editable clone (development mode)

```bash
git clone https://github.com/AminoAnalytica/protein-monte-carlo.git
cd protein-monte-carlo
pip install -e ".[dev]"   # installs with dev extras from pyproject.toml
```

> **Tip — GPU:** set `model.device: "cuda:0"` in your YAML config.

---

## Quickstart

1. **Grab a config** (YAML or JSON). Save the snippet below as `example_config.yml`:

```yaml
model:
  device: cpu           # "cuda:0" for GPU

sim:
  sequence_file: ../data/demo_sequences.csv
  sequence_index: 0
  beta: 0.5
  num_steps: 100
  protected_positions: [10, 25]  # optional 1‑based positions
  status_frequency: 10

paths:
  results_dir: ./results
```

2. **Run the optimiser**

```bash
# console script autogenerated by pyproject [project.scripts]
protein-mc-run --config example_config.yml --output results.csv

# or module entry‑point
python -m protein_mc.cli.run_simulation --config example_config.yml -o results.csv
```

Example progress output:

```
step   10 | ΔE=+0.00360 | ✓ p=0.997 | hamming=8 | seq=MKSQYIAKQRQISMIKSHCS… | 00:00 elapsed, 00:00 left
```

3. **Inspect results** — `results.csv` contains per‑step ΔE, acceptance flag, live sequence, and Hamming distance.

---

## How it works

| component            | role                                                      |
| -------------------- | --------------------------------------------------------- |
| `models.esm_wrapper` | Loads an ESM2‑T6 (8 M) HF **feature‑extraction** pipeline |
| `core.sequence_ops`  | Generates single‑point mutants & caches embeddings        |
| `core.energy`        | Computes ΔE = α · (E<sub>mut</sub> − E<sub>prev</sub>)    |
| `core.monte_carlo`   | Metropolis sampler in embedding space                     |
| `utils.progress`     | Uniform progress reporter                                 |

Everything is pure‑Python; no custom CUDA kernels.

![flowchart](https://github.com/user-attachments/assets/b29718bc-a15d-45d7-bc93-2787236070db)

---

## Cite

> *Protein‑MC: Minimal Monte‑Carlo optimiser for protein sequence design*. **bioRxiv** (2025). DOI: *coming soon*
> Software release v0.1.0 (Zenodo): DOI *coming soon*

---

## License

MIT — fork it, cite it, improve it.
